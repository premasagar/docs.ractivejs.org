<!doctype html>
<html lang='en-GB'>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=Edge,chrome=1'>

	<title> Publish/subscribe | Docs | Ractive.js </title >

	<meta name='viewport' content='width=device-width'>

	<link rel='icon' type='image/png' href='../assets/favicon.png'>
	<link rel='stylesheet' href='../min.css'>

	<!--[if lte IE 8]>
		<script src='../assets/respond.min.js'></script>
		<script src='../assets/html5shiv.min.js'></script>
	<![endif]-->

</head>

<body class='example'>

	<nav>
	<div class='nav-inner'>
		<a href='http://ractivejs.org'>Ractive.js</a>

		<ul>
			<li><a href='http://ractivejs.org/60-second-setup'>60 second setup</a></li>
			<li><a href='http://learn.ractivejs.org'>Tutorials</a></li>
			<li><a href='http://examples.ractivejs.org'>Examples</a></li>
			<li class="selected"><a href='http://docs.ractivejs.org'>Docs</a></li>
			<li><a href='http://docs.ractivejs.org/latest/plugins'>Plugins</a></li>
			<li><a href='http://blog.ractivejs.org'>Blog</a></li>
			<li class='github-small'><a href='https://github.com/ractivejs/ractive'>GitHub</a></li>
		</ul>

		<a class='github-wide' href='https://github.com/ractivejs/ractive'>GitHub</a>

		<button id='nav-toggle'>&#9776;</button>
	</div>
</nav>


	<main>
		<div class='content'>
			<header class='main-header'>
				<h1>Publish/subscribe</h1>
				<a class='edit-link' href='https://github.com/ractivejs/docs.ractivejs.org/edit/master/docs/0.6/Publish-subscribe.md.hbs'>edit this page</a>
			</header>

			<p>Like many libraries, Ractive implements the <a href="http://addyosmani.com/blog/understanding-the-publishsubscribe-pattern-for-greater-javascript-scalability/">publish/subscribe</a> mechanism to allow you to respond to, or trigger, particular events.</p>
<h2 id="subscribe">Subscribe</h2>
<p>To subscribe to an event, use <a href="ractive-on">ractive.on()</a>:</p>
<pre><code class="language-js">ractive = <span class="keyword">new</span> Ractive({
  el: <span class="string">'body'</span>,
  template: <span class="string">'&lt;button on-click="activate"&gt;click me!&lt;/button&gt;'</span>
});

ractive.on( <span class="string">'activate'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  alert( <span class="string">'Activating!'</span> );
});</code></pre>
<p>This can be used to subscribe to any of the following type of events:</p>
<ul>
<li><a href="proxy-events">Proxy events</a> for DOM and custom events defined in your template</li>
<li><a href="lifecycle-events">Lifecycle events</a> generated by each ractive instance - such as <code>init</code>, <code>render</code> and <code>teardown</code></li>
<li><a href="#publish">Custom events</a> fired in code using <a href="ractive-fire">ractive.fire()</a>, which can be anything you like, see below.</li>
</ul>
<h3 id="multiple-events-to-one-handler">Multiple events to one handler</h3>
<p>You can subscribe a handler to more than one event by seperating event names with a space:</p>
<pre><code class="language-js">ractive.on( <span class="string">'activate select'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>...} );</code></pre>
<p>This example will fire for either an <code>activate</code> event or a <code>select</code> event.</p>
<h3 id="object-map-of-multiple-event-handler-pairs">Object map of multiple event/handler pairs</h3>
<p>Multiple hander/function pairs can be subscribed using an object hash:</p>
<pre><code class="language-js">ractive.on({
    activate: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>...},
    select: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>...}
});</code></pre>
<h3 id="wildcard-pattern-handlers">Wildcard pattern handlers</h3>
<p>Event names that use a keypath-like name can be subscribed using the pattern-matching wildcard &quot;<code>*</code>&quot; for any name path segment:</p>
<pre><code class="language-js">ractive.on( <span class="string">'foo.*'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>...} );</code></pre>
<p>This example will fire on any event name that starts with <code>foo.</code> - <code>foo.active</code>, <code>foo.select</code>, etc.</p>
<p>This is very useful with <a href="event-bubbling">event bubbling</a> and auto-prefixed event names that bubble up from components.</p>
<p>Be aware that handlers like <code>widget.*</code> or <code>*</code> will fire for <em>all</em> matching events, including <a href="lifecycle-events">lifecycle events</a>.</p>
<h3 id="accessing-the-event-object">Accessing the event object</h3>
<p>In addition to the event argument that is passed with proxy events, the event object can be accessed using <code>this.event</code> in the function body of any handler. This object is also present in non-proxy events including lifecycle events, though it includes a more limited set of properties.</p>
<p>Properties on all <code>this.event</code> objects:</p>
<ul>
<li><code>this.event.name</code> - the name of the event</li>
<li><code>this.event.context</code> - the value of <code>this.get(event.keypath)</code> or <code>ractive.data</code> for non-proxy events</li>
<li><code>this.event.component</code> - the component that raised the event, only present on <a href="event-bubbling">bubbled events</a></li>
<li><code>this.event.original</code> - the original DOM event, if available</li>
</ul>
<p>Properties only on proxy events:</p>
<ul>
<li><code>this.event.node</code> - the DOM node in question</li>
<li><code>this.event.keypath</code> - the <a href="keypaths">keypath</a> of the current context</li>
<li><code>this.event.index</code> - a map of index references</li>
</ul>
<p>One useful aspect of <code>this.event</code> is that the name of the event can be determined when wildcards are used:</p>
<pre><code class="language-js">ractive.on( <span class="string">'foo.*'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    console.log( <span class="keyword">this</span>.event.name );
});</code></pre>
<h3 id="cancelling-dom-events">Cancelling DOM events</h3>
<p>If you return &#39;false&#39; from a proxy event handler, ractive will automatically call both <code>preventDefault()</code> and <code>stopPropagation()</code> on the original DOM event.</p>
<p>Note that returning <code>false</code> has a duel purpose of both cancelling the view hierarchy <a href="event-bubbling">event bubbling</a> <strong>as well as</strong> cancelling the DOM Event if the event was DOM-based.</p>
<h2 id="unsubscribe">Unsubscribe</h2>
<p>Event handlers are automatically removed if the instance is torn down (e.g. with <a href="ractive-teardown">ractive.teardown()</a>) (which also happens as components are removed due to template/data logic).</p>
<p>You can also unsubscribe event handlers manually using one of two approaches:</p>
<pre><code class="language-js"><span class="keyword">var</span> listener = ractive.on( <span class="string">'activate'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  alert( <span class="string">'Activating!'</span> );
});

<span class="comment">// later...</span>
listener.cancel();</code></pre>
<p>or...</p>
<pre><code class="language-js"><span class="keyword">var</span> handler = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  alert( <span class="string">'Activating!'</span> );
};

ractive.on( <span class="string">'activate'</span>, handler );

<span class="comment">// later...</span>
ractive.off( <span class="string">'activate'</span>, handler );</code></pre>
<p>In the second case, note that if you don&#39;t specify a handler, all &#39;activate&#39; handlers will be removed. If you don&#39;t specify an event name, <strong>all</strong> event handlers will be removed from the instance. See <a href="ractive-off">ractive.off()</a> for more detail.</p>
<p>The <code>ractive.off()</code> method is chainable for easily replacing subscribtions:</p>
<pre><code class="language-js">ractive.off( <span class="string">'activate'</span> ).on( <span class="string">'activate'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>...} );</code></pre>
<h2 id="publish">Publish</h2>
<p>In addition to the built-in <a href="lifecycle-events">lifecycle events</a> and <a href="proxy-events">proxy events</a>, you can fire your own events with <a href="ractive-fire">ractive.fire()</a>.</p>
<p>This is most useful in the context of a <a href="components">component</a> that needs to emit custom events. Here&#39;s a (somewhat contrived) example:</p>
<pre><code class="language-js"><span class="keyword">var</span> Ticker = Ractive.extend({
  oninit: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    <span class="keyword">var</span> i = <span class="number">1</span>;

    <span class="keyword">this</span>.interval = setInterval( <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">this</span>.fire( <span class="string">'tick'</span>, i++ );
    }.bind( <span class="keyword">this</span> ), <span class="number">1000</span> );
  },
  onteardown: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    clearInterval( <span class="keyword">this</span>.interval );
  }
});

<span class="keyword">var</span> ticker = <span class="keyword">new</span> Ticker();

ticker.on( <span class="string">'tick'</span>, <span class="function"><span class="keyword">function</span> <span class="params">( i )</span> {</span>
  console.log( i % <span class="number">2</span> ? <span class="string">'tick'</span> : <span class="string">'tock'</span> );
});</code></pre>

		</div>

		<aside class="left-nav">
			<section>
	<h1>Introduction</h1>
	<ul>
		<li><a href="get-started">Get started</a></li>
		<li><a href="tips">Tips</a></li>
		<li><a href="get-support">Get support</a></li>
		<li><a href="contributing">Contributing</a></li>
		<li><a href="get-started-with-node-js">Get started with node.js</a></li>
		<li><a href="migrating">Migrating from previous versions</a></li>
	</ul>
</section>

<section>
	<h1>Configuration</h1>
	<ul>
		<li><a href="options">Options</a></li>
		<li><a href="ractive-defaults">Defaults</a></li>
		<li><a href="advanced-configuration">Advanced configuration</a></li>
	</ul>
</section>
<section>
	<h1>Core Concepts</h1>
	<h2>Templates</h2>
	<ul>
		<li><a href="templates">Templates</a></li>
		<li><a href="mustaches">Mustaches</a></li>
		<li><a href="references">References</a></li>
		<li><a href="expressions">Expressions</a></li>
		<li><a href="keypaths">Keypaths</a></li>
		<li><a href="partials">Partials</a></li>
		<li><a href="decorators">Decorators</a></li>
	</ul>
	<h2>Data & Binding</h2>
	<ul>
		<li><a href="two-way-binding">Two-way binding</a></li>
		<li><a href="magic-mode">Magic mode</a></li>
		<li><a href="dependants">Dependants</a></li>
		<li><a href="array-modification">Array modification</a></li>
		<li><a href="computed-properties">Computed Properties</a></li>
		<li><a href="observers">Observers</a></li>
		<li><a href="adaptors">Adaptors</a></li>
		<li><a href="parallel-dom">Parallel DOM</a></li>
	</ul>
	<h2>Events</h2>
	<ul>
		<li><a href="events-overview">Overview</a></li>
		<li><a href="event-directives">Event directives</a></li>
		<li><a href="proxy-events">Proxy events</a></li>
		<li><a href="method-calls">Method calls</a></li>
		<li><a href="publish-subscribe">Publish/subscribe</a></li>
		<li><a href="event-bubbling">Event bubbling</a></li>
		<li><a href="lifecycle-events">Lifecycle events</a></li>
	</ul>
	<h2>Transitions and Animations</h2>
	<ul>
		<li><a href="transitions">Transitions</a></li>
		<li><a href="promises">Promises</a></li>
		<li><a href="ractive-easing">Easings</a></li>
	</ul>
	<h2>Components</h2>
	<ul>
		<li><a href="components">Components</a></li>
	</ul>
</section>
<section>
	<h1>API Reference</h1>
	<h2>Constructor</h2>
	<ul>
		<li><a href="new-ractive">new Ractive(...)</a></li>
	</ul>
	<h2>Instance methods</h2>
	<ul>
		<li><a href="ractive-add">ractive.add()</a></li>
		<li><a href="ractive-animate">ractive.animate()</a></li>
		<li><a href="ractive-detach">ractive.detach()</a></li>
		<li><a href="ractive-find">ractive.find()</a></li>
		<li><a href="ractive-findall">ractive.findAll()</a></li>
		<li><a href="ractive-findallcomponents">ractive.findAllComponents()</a></li>
		<li><a href="ractive-findcomponent">ractive.findComponent()</a></li>
		<li><a href="ractive-fire">ractive.fire()</a></li>
		<li><a href="ractive-get">ractive.get()</a></li>
		<li><a href="ractive-insert">ractive.insert()</a></li>
		<li><a href="ractive-merge">ractive.merge()</a></li>
		<li><a href="ractive-observe">ractive.observe()</a></li>
		<li><a href="ractive-off">ractive.off()</a></li>
		<li><a href="ractive-on">ractive.on()</a></li>
		<li><a href="ractive-pop">ractive.pop()</a></li>
		<li><a href="ractive-push">ractive.push()</a></li>
		<li><a href="ractive-render">ractive.render()</a></li>
		<li><a href="ractive-reset">ractive.reset()</a></li>
		<li><a href="ractive-set">ractive.set()</a></li>
		<li><a href="ractive-shift">ractive.shift()</a></li>
		<li><a href="ractive-splice">ractive.splice()</a></li>
		<li><a href="ractive-subtract">ractive.subtract()</a></li>
		<li><a href="ractive-teardown">ractive.teardown()</a></li>
		<li><a href="ractive-toggle">ractive.toggle()</a></li>
		<li><a href="ractive-tohtml">ractive.toHTML()</a></li>
		<li><a href="ractive-unrender">ractive.unrender()</a></li>
		<li><a href="ractive-unshift">ractive.unshift()</a></li>
		<li><a href="ractive-update">ractive.update()</a></li>
		<li><a href="ractive-updatemodel">ractive.updateModel()</a></li>
	</ul>
	<h2>Instance properties</h2>
	<ul>
		<li><a href="ractive-nodes">ractive.nodes</a></li>
		<li><a href="ractive-transitions-instance">ractive.transitions</a></li>
		<li><a href="ractive-partials-instance">ractive.partials</a></li>
	</ul>
	<h2>Static methods</h2>
	<ul>
		<li><a href="ractive-extend">Ractive.extend()</a></li>
		<li><a href="ractive-parse">Ractive.parse()</a></li>
	</ul>
	<h2>Static properties</h2>
	<ul>
		<li><a href="ractive-defaults">Ractive.defaults</a></li>
		<li><a href="ractive-easing">Ractive.easing</a></li>
	</ul>
</ul>
</section>
<section>
	<h1>Plugins</h1>
	<h2>Using</h2>
	<ul>
		<li><a href="plugins">List of plugins</a></li>
	</ul>
	<h2>Writing</h2>
	<ul>
		<li><a href="writing-adaptor-plugins">Adaptors</a></li>
		<li><a href="writing-decorator-plugins">Decorators</a></li>
		<li><a href="writing-event-plugins">Events</a></li>
		<li><a href="writing-transition-plugins">Transitions</a></li>
	</ul>
</section>

<section>
	<h1>Specific versions</h1>

	<ul>
		<li><a href='../edge'>edge</a></li>
		<li><a href='../0.6'>0.6</a></li>
		<li><a href='../0.5'>0.5</a></li>
		<li><a href='../0.4.0'>0.4.0</a></li>
		<li><a href='../0.3.9'>0.3.9</a></li>
	</ul>
</section>

		</aside>
	</main>

	<footer>
	<p>Ractive.js is a free and open source project released under the MIT license.</p>
</footer>


	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-5602942-6', 'ractivejs.org');
	ga('send', 'pageview');
</script>


	<script src='../assets/nav.js'></script>

</body>
</html>
